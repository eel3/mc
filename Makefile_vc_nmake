# @brief   mc Makefile for Visual C++ and NMAKE.
# @author  eel3
# @date    2015/05/08
#
# @note
# - Visual Studio 2013 Professional SP1

app         = mc
objs        = parser.obj lexer.obj $(app).obj

CFLAGS      = /GS /W4 /MT /FI io.h /D _CRT_SECURE_NO_WARNINGS /D YY_NO_UNISTD_H /D YYDEBUG=0 /D YYERROR_VERBOSE

RM          = del /f /q

all: $(app).exe

$(app).exe: $(objs)
	link.exe /OUT:$@ /SUBSYSTEM:CONSOLE $**

lexer.c: lexer.l
	flex -o $@ $?

parser.c: parser.y
	bison -d -y $?
	copy /b /y y.tab.c $@
	$(RM) y.tab.c

clean:
	$(RM) $(app).exe $(objs) lexer.c parser.c y.tab.h
